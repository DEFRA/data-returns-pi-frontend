{% extends 'layout/layout.html' %}

{% macro form(header, action) %}
<h1 class="heading-large">{{ header }}</h1>
<h2 class="font-medium">EA_ID: {{ eaId }}</h2>
<form action="{{ action }}-validate" method="post" class="form">
    <table class="check-data table-control mobile-format">
        <thead>
        <tr>
            <th class="th-substance">Substance</th>
            <th class="th-reporting-threshold numeric">2017 threshold</th>
            <th class="th-release">2017 total</th>
            <th class="th-unit">Unit</th>
            <th class="th-action"><span class="visually-hidden">More detail</span></th>
        </tr>
        </thead>
        <tbody>
        {% for release in releases %}
        <tr>
            <td class="td-substance">{{ release.substance.name }}</td>
            <td class="td-reporting-threshold numeric"></td>
            <td class="td-release"> <label class="form-label visually-hidden" for="value-{{ release.substance.id }}">Releases</label>
                <input class="form-control" id="value-{{ release.substance.id }}" name="value-{{ release.substance.id }}" value="{{ release.value }}"> </td>
            <td class="td-unit">
                <label class="form-label visually-hidden" for="unit-{{ release.substance.id }}">Unit</label>
                <select class="form-control unit" id="unit-{{ release.substance.id }}" name="unitId-{{ release.substance.id }}">
                    <option>--</option>
                    {% for unit in units %}
                    {% if release.unitId === unit.id %}
                    <option selected value="{{ unit.id }}">{{ unit.name }}</option>
                    {% else %}
                    <option value="{{ unit.id }}">{{ unit.name }}</option>
                    {% endif %}
                    {% endfor %}
                </select>
            </td>
            <td class="td-action"><a href="/">More detail</a></td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
    <div class="form-group"> <a href="/add-substance">Add a new substance</a> </div>
    <div class="form-group"> <input type="submit" class="button" value="Continue"> </div>
</form>
{% endmacro %}

{% block content %}
<main id="content">
    {% if task === 'RELEASES_TO_LAND'%}
    {{ form('Your releases to land?', '/land') }}
    {% elif task === 'RELEASES_TO_AIR' %}
    {{ form('Your releases to air?', '/air') }}
    {% elif task === 'RELEASES_TO_CONTROLLED_WATERS' %}
    {{ form('Your releases to controlled waters?', '/water') }}
    {% elif task === 'OFFSITE_TRANSFERS_IN_WASTE_WATER' %}
    {{ form('Your transfers of substances off-site in waste water?', '/waste-water') }}
    {% endif %}
</main>
{% endblock %}